<?php if (!defined("BASEPATH")) exit("No direct script access allowed");
/**
 * PregnancyReviewManager
 * This class has been auto-generated by Itirra
 */
require_once APPPATH . 'logic/base/BaseManager.php';
class PregnancyReviewManager extends BaseManager {

  /** Fields. */
  public $fields = array("name" => array("type" => "tinymce", "class" => "required charCounter", "attrs" => array("maxlength" => 65535)),
                         "date" => array("type" => "date", "class" => "required"),
                         "user" => array("type" => "select", "relation" => array("entity_name" => "User")),
                         "author_pregnancy_week" => array("type" => "select", "relation" => array("entity_name" => "PregnancyWeek")));

  /** List params. */
  public $listParams = array("date", "user.name", "author_pregnancy_week.name");
  
  /**
   * PreProcessWhereQuery.
   * OVERRIDE THIS METHOD IN A SUBCLASS TO ADD joins and other stuff.
   * @param Doctrine_Query $query
   * @return Doctrine_Query
   */
  protected function preProcessWhereQuery($query, $pref, $what = '*') {
    $query = parent::preProcessWhereQuery($query, $pref, $what);
    if (strpos($what, 'user.') !== FALSE || $what == '*') {
      $query->addSelect("user_pregnancyweek.*")->leftJoin("user.pregnancyweek_current user_pregnancyweek");
    }
  
    return $query;
  }

}