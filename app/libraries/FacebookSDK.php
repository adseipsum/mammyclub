<?php if (!defined('BASEPATH')) exit('No direct script access allowed');

require_once BASEPATH . 'facebook-sdk/autoload.php';

use FacebookAds\Api;
use FacebookAds\Object\Lead;
use FacebookAds\Object\LeadgenForm;
use FacebookAds\Object\UserLeadGenFieldData;
use FacebookAds\Object\AdAccount;
use FacebookAds\Object\CustomAudience;
use FacebookAds\Object\Values\CustomAudienceTypes;
use FacebookAds\Object\Fields\CustomAudienceFields;
use FacebookAds\Object\Values\CustomAudienceSubtypes;
use Facebook\FacebookResponse;

/**
 * FacebookSDK library
 */
class FacebookSDK {

	/** App ID. */
	private $app_id = '165159744058123';

	/** App Secret. */
	private $app_secret = 'f12a3bb1f6ff6fc3a7071963cc8f5d60';

	/**
	 *  Page Token (never expire)
	 *  To get this token you need follow the steps:
	 *  1) Receive long-live user token (about 60 days) - https://graph.facebook.com/oauth/access_token?client_id=<APP_ID>&client_secret=<APP_SECTRET>&grant_type=fb_exchange_token&fb_exchange_token=<SHORT_LIVE_USER_TOKEN>
	 *  2) Receive never expire page token - https://developers.facebook.com/tools/explorer/?method=GET - <PAGE_ID>?fields=access_token
	 *  You can check this token here: https://developers.facebook.com/tools/debug/accesstoken
	 *  More info about tokens and expiration: https://developers.facebook.com/docs/facebook-login/access-tokens/expiration-and-extension
	 **/
	//                        EAACWNjZCgMwsBAHFmwwZBB4FNvaJlVX5OFd0KVkmLw9sYTOuetvMYN4DsulF8m72uCZBBZBxpOk3afdNpewNWvkL0oTyPZCnRfDSArEza7ZBlPJNsTkggIZBq7tsJMivexBrc8dUo02VsdJH0DlGNKff8HZCNzvDkA3bx4UhZCJQzAWgg0BsfmH401BGVqbLGyJQZD
//	private $page_token = 'EAACWNjZCgMwsBALmTZCjYfZBWEJqAKySeCOaGhOXGoIXGCxoFZBTswHWZA36Iw2bWyIwauBn4skMNXaAMcwfU8YDp4XdbYrIrBeKOgw0RpdGsGTHfRZCVcZBexuo5wtuGYEJv19f5KtqXNkGZAJdku7EBdxTZBAopFq4ZD';
	private $page_token = 'EAACWNjZCgMwsBALOzdDQNW7RAE1pu5ZAJBXXJ1ASKR6RVqSYZCTHzuJJVwZC04EzO4GEWBRJd0fipWC42zpYT7Ebc4FJpsrZBJ3g2bET5Sx4emlnOHVJLRRjkUEdEIsXRhMDKtQZAbtdpMnBCWPb49F7fZAbMdt0bLLBAZCW8FpMJgZDZD';

	/** Add account. */
	private $account_id = 'act_516395731870839';



	/**
	 * $fbGraph
	 * instance of Facebook Graph SDK
	 */
	private $fbGraph;

	/**
	 * $fbAds
	 * instance of Facebook Ads SDK
	 */
	private $fbAds;


	/**
	 * Constructor.
	 */
	public function FacebookSDK() {
		$this->initGraphSDK();
		$this->initAdsSDK();

	}

  /**
   * @param $actAccount
   * @return array
   */
	public function getAllCustomAudiences($actAccount){
		$field = array(
			CustomAudienceFields::NAME,
			CustomAudienceFields::ID);
		$account = new AdAccount($actAccount);
		$audiences = $account->getCustomAudiences($field);
		$audience = array();
		foreach ($audiences as $value){
			$audience[$value->name] = $value->id;
		}
		return $audience;
	}


  /**
   * @param $actAccount
   * @param $name
   * @param null $description
   * @param $communications
   * @param $communicationType
   * @return mixed
   * @throws Exception
   */
	public function addNewAudiences($actAccount, $name, $description = null, $phonesOrEmails, $communicationType) {

    $phonesOrEmailsNew = array(
      '+380937829055',
'+380937872478',
'+380937955373',
'+380937993600',
'+380937998528',
'+380938106045',
'+380938258377',
'+380938330916',
'+380938332200',
'+380938351982',
'+380938431295',
'+380938456187',
'+380938461141',
'+380938473131',
'+380938481741',
'+380938499238',
'+380938499716',
'+380938531368',
'+380938547939',
'+380938597256',
'+380938866999',
'+380939041390',
'+380939069351',
'+380939117460',
'+380939163463',
'+380939202358',
'+380939244922',
'+380939359616',
'+380939423542',
'+380939494138',
'+380939525191',
'+380939640384',
'+380939698905',
'+380939780120',
'+380939813605',
'+380939921864',
'+380939952077',
'+380950171329',
'+380950385995',
'+380950413513',
'+380950466259',
'+380950483299',
'+380950742838',
'+380950781372',
'+380950825658',
'+380950876159',
'+380950928911',
'+380950933497',
'+380950940845',
'+380950941407',
'+380951103545',
'+380951165530',
'+380951186685',
'+380951191811',
'+380951281918',
'+380951454240',
'+380951457188',
'+380951565615',
'+380951618466',
'+380951765859',
'+380951806809',
'+380951954033',
'+380952020627',
'+380952031143',
'+380952126856',
'+380952155593',
'+380952190823',
'+380952229035',
'+380952418373',
'+380952493981',
'+380952506300',
'+380952589952',
'+380952707614',
'+380952811708',
'+380952812169',
'+380952855554',
'+380953032589',
'+380953082708',
'+380953092230',
'+380953117553',
'+380953142773',
'+380953214100',
'+380953244702',
'+380953252472',
'+380953261556',
'+380953315424',
'+380953319555',
'+380953330708',
'+380953342636',
'+380953362036',
'+380953448742',
'+380953524058',
'+380953552345',
'+380953555454',
'+380953677889',
'+380953814324',
'+380953989700',
'+380954003052',
'+380954033717',
'+380954099018',
'+380954211397',
'+380954217674',
'+380954265545',
'+380954401249',
'+380954470213',
'+380954665215',
'+380954667076',
'+380954679141',
'+380954701668',
'+380954800014',
'+380954802149',
'+380954824333',
'+380954866921',
'+380954871001',
'+380955002350',
'+380955091521',
'+380955120666',
'+380955276577',
'+380955354211',
'+380955577941',
'+380955626613',
'+380955634455',
'+380955802925',
'+380956020258',
'+380956089425',
'+380956113177',
'+380956174959',
'+380956212313',
'+380956286913',
'+380956331510',
'+380956349455',
'+380956400582',
'+380956434656',
'+380956544904',
'+380956592734',
'+380956605432',
'+380956770856',
'+380956865872',
'+380956918045',
'+380956934165',
'+380956976110',
'+380956987785',
'+380957000737',
'+380957140770',
'+380957167677',
'+380957183935',
'+380957215025',
'+380957293501',
'+380957301147',
'+380957343244',
'+380957343910',
'+380957370107',
'+380957389800',
'+380957443820',
'+380957454219',
'+380957501136',
'+380957555192',
'+380957587575',
'+380957710887',
'+380957756143',
'+380957759929',
'+380957778998',
'+380957884382',
'+380957920121',
'+380957943554',
'+380958029541',
'+380958077803',
'+380958095834',
'+380958234212',
'+380958572470',
'+380958660283',
'+380958732409',
'+380958737842',
'+380958754208',
'+380958819798',
'+380958919225',
'+380958962289',
'+380959106560',
'+380959131870',
'+380959141838',
'+380960298402',
'+380960327229',
'+380960403155',
'+380960427184',
'+380960532299',
'+380960702222',
'+380960747974',
'+380960770070',
'+380960825531',
'+380960826133',
'+380960868584',
'+380960962925',
'+380961036190',
'+380961110703',
'+380961139948',
'+380961154307',
'+380961384847',
'+380961406036',
'+380961415111',
'+380961425236',
'+380961505000',
'+380961520388',
'+380961564831',
'+380961677861',
'+380961705558',
'+380961705892',
'+380961892006',
'+380961901110',
'+380961926389',
'+380961936940',
'+380962158559',
'+380962212394',
'+380962215522',
'+380962257884',
'+380962377391',
'+380962445217',
'+380962457444',
'+380962531841',
'+380962808052',
'+380962888955',
'+380962939987',
'+380963109413',
'+380963137417',
'+380963171445',
'+380963325439',
'+380963350265',
'+380963366975',
'+380963392353',
'+380963395645',
'+380963623051',
'+380963717124',
'+380963733525',
'+380964043387',
'+380964073200',
'+380964132891',
'+380964217433',
'+380964252345',
'+380964317438',
'+380964455490',
'+380964464515',
'+380964494144',
'+380964657135',
'+380964972380',
'+380965330678',
'+380965334081',
'+380965405626',
'+380965483614',
'+380965496462',
'+380965571473',
'+380965640686',
'+380965774999',
'+380965789885',
'+380965800309',
'+380965820672',
'+380965841609',
'+380965936655',
'+380966005702',
'+380966087354',
'+380966100302',
'+380966115559',
'+380966116235',
'+380966145329',
'+380966248977',
'+380966268796',
'+380966309148',
'+380966433419',
'+380966439532',
'+380966508506',
'+380966512544',
'+380966515646',
'+380966535784',
'+380966604128',
'+380966620384',
'+380966882151',
'+380966916706',
'+380966949434',
'+380966950776',
'+380966961685',
'+380966964436',
'+380966993889',
'+380967012177',
'+380967065576',
'+380967094696',
'+380967137947',
'+380967171768',
'+380967183830',
'+380967228001',
'+380967352297',
'+380967376919',
'+380967380735',
'+380967393020',
'+380967404917',
'+380967441793',
'+380967513024',
'+380967544744',
'+380967555802',
'+380967557808',
'+380967568038',
'+380967622615',
'+380967722389',
'+380967899809',
'+380967910777',
'+380967914454',
'+380967919443',
'+380967983123',
'+380968038061',
'+380968052365',
'+380968100500',
'+380968111918',
'+380968117851',
'+380968174277',
'+380968314737',
'+380968411359',
'+380968413610',
'+380968462727',
'+380968478880',
'+380968484848',
'+380968518707',
'+380968560618',
'+380968570921',
'+380968580237',
'+380968664641',
'+380968674261',
'+380968695583',
'+380968762462',
'+380968776722',
'+380968800175',
'+380968928167',
'+380968972773',
'+380968987068',
'+380969071103',
'+380969102493',
'+380969155077',
'+380969173447',
'+380969175191',
'+380969182078',
'+380969303187',
'+380969324576',
'+380969327778',
'+380969408074',
'+380969452881',
'+380969484930',
'+380969495772',
'+380969564454',
'+380969627341',
'+380969639118',
'+380969692853',
'+380969764850',
'+380969806708',
'+380969824607',
'+380969833548',
'+380969835804',
'+380969892592',
'+380969909297',
'+380969991820',
'+380970134613',
'+380970145825',
'+380970170303',
'+380970499215',
'+380970553289',
'+380970557072',
'+380970921802',
'+380971119854',
'+380971171374',
'+380971172772',
'+380971212739',
'+380971333111',
'+380971344438',
'+380971378833',
'+380971473550',
'+380971489565',
'+380971550454',
'+380971654177',
'+380971654365',
'+380971672696',
'+380971793527',
'+380971845712',
'+380971859198',
'+380971880327',
'+380971939999',
'+380971953903',
'+380971959392',
'+380971967705',
'+380972192443',
'+380972309300',
'+380972334422',
'+380972355659',
'+380972520969',
'+380972525985',
'+380972603878',
'+380972634379',
'+380972675020',
'+380972692145',
'+380972755279',
'+380972797142',
'+380972807424',
'+380973024603',
'+380973112156',
'+380973116925',
'+380973244237',
'+380973245035',
'+380973305529',
'+380973326991',
'+380973332053',
'+380973339941',
'+380973360797',
'+380973393320',
'+380973520030',
'+380973568333',
'+380973744563',
'+380973794800',
'+380973865454',
'+380974016982',
'+380974064301',
'+380974082232',
'+380974119988',
'+380974292973',
'+380974314700',
'+380974332897',
'+380974402038',
'+380974405022',
'+380974440014',
'+380974552794',
'+380974594104',
'+380974690330',
'+380974754843',
'+380974772205',
'+380974810172',
'+380974849771',
'+380974902600',
'+380974974590',
'+380975004284',
'+380975060164',
'+380975127119',
'+380975249935',
'+380975323630',
'+380975504208',
'+380975514897',
'+380975726699',
'+380975734734',
'+380975743115',
'+380975874145',
'+380975886986',
'+380975954757',
'+380976018510',
'+380976023932',
'+380976125315',
'+380976146861',
'+380976160569',
'+380976174559',
'+380976232057',
'+380976238787',
'+380976401282',
'+380976420941',
'+380976452684',
'+380976481768',
'+380976490468',
'+380976503969',
'+380976525670',
'+380976540364',
'+380976545571',
'+380976584791',
'+380976586671',
'+380976588641',
'+380976638342',
'+380976671067',
'+380976707196',
'+380976805720',
'+380976818781',
'+380976820886',
'+380976820938',
'+380976863769',
'+380976864688',
'+380976868797',
'+380976886032',
'+380976892530',
'+380977064553',
'+380977173157',
'+380977191985',
'+380977268400',
'+380977334542',
'+380977337687',
'+380977350128',
'+380977371060',
'+380977376013',
'+380977392490',
'+380977412903',
'+380977432500',
'+380977462359',
'+380977481814',
'+380977493964',
'+380977506117',
'+380977534422',
'+380977572518',
'+380977634533',
'+380977637274',
'+380977656586',
'+380977716353',
'+380977717096',
'+380977738495',
'+380977760834',
'+380977769967',
'+380977779009',
'+380977783733',
'+380977818271',
'+380977834384',
'+380977862327',
'+380977977290',
'+380977984824',
'+380978068198',
'+380978073523',
'+380978130119',
'+380978168767',
'+380978177566',
'+380978189417',
'+380978205384',
'+380978211486',
'+380978241786',
'+380978257057',
'+380978263442',
'+380978320952',
'+380978433843',
'+380978436614',
'+380978444870',
'+380978449508',
'+380978501649',
'+380978541957',
'+380978545518',
'+380978643640',
'+380978647058',
'+380978675088',
'+380978723128',
'+380978729096',
'+380978805102',
'+380978882260',
'+380978909339',
'+380978922047',
'+380978959768',
'+380978966412',
'+380978984764',
'+380979007679',
'+380979039516',
'+380979041109',
'+380979074814',
'+380979161546',
'+380979176592',
'+380979224815',
'+380979233499',
'+380979248330',
'+380979270075',
'+380979294674',
'+380979300717',
'+380979333102',
'+380979359144',
'+380979370654',
'+380979395775',
'+380979397043',
'+380979437264',
'+380979456410',
'+380979463407',
'+380979472219',
'+380979482354',
'+380979508646',
'+380979510169',
'+380979514565',
'+380979518637',
'+380979548016',
'+380979558051',
'+380979594094',
'+380979613328',
'+380979657069',
'+380979668519',
'+380979671801',
'+380979685192',
'+380979689378',
'+380979702330',
'+380979708748',
'+380979740465',
'+380979748622',
'+380979799059',
'+380979801752',
'+380979827030',
'+380979914592',
'+380979937181',
'+380979950835',
'+380980006190',
'+380980048880',
'+380980180915',
'+380980555000',
'+380980669499',
'+380980686993',
'+380980732262',
'+380980773352',
'+380980909712',
'+380980914141',
'+380980920434',
'+380980986989',
'+380980999846',
'+380981000019',
'+380981008488',
'+380981072319',
'+380981210680',
'+380981212141',
'+380981280109',
'+380981330656',
'+380981610161',
'+380981726268',
'+380981756646',
'+380982046798',
'+380982087200',
'+380982134589',
'+380982191530',
'+380982226125',
'+380982247781',
'+380982395927',
'+380982454098',
'+380982518900',
'+380982552515',
'+380982558542',
'+380982578236',
'+380982755556',
'+380982829372',
'+380982865671',
'+380982976869',
'+380983005033',
'+380983121344',
'+380983280098',
'+380983414188',
'+380983440832',
'+380983511888',
'+380983627314',
'+380983795254',
'+380983975177',
'+380984241909',
'+380984250170',
'+380984583874',
'+380984628827',
'+380984681358',
'+380984740860',
'+380984894444',
'+380984955193',
'+380984956178',
'+380985150172',
'+380985235758',
'+380985335450',
'+380985552642',
'+380985567828',
'+380985599487',
'+380985664096',
'+380985757587',
'+380985795245',
'+380985823217',
'+380985841077',
'+380985908380',
'+380985921942',
'+380986084388',
'+380986087195',
'+380986245411',
'+380986254306',
'+380986298681',
'+380986378559',
'+380986501963',
'+380986669302',
'+380987018315',
'+380987087993',
'+380987183384',
'+380987232999',
'+380987259780',
'+380987457705',
'+380987545768',
'+380987608637',
'+380987649165',
'+380987663336',
'+380987737311',
'+380987742609',
'+380987742892',
'+380987886924',
'+380987909031',
'+380987983664',
'+380988039386',
'+380988040010',
'+380988060343',
'+380988107289',
'+380988140787',
'+380988165455',
'+380988207752',
'+380988212400',
'+380988255511',
'+380988313677',
'+380988337927',
'+380988398592',
'+380988498284',
'+380988641141',
'+380988666265',
'+380988691800',
'+380988757752',
'+380988909458',
'+380988982324',
'+380989085847',
'+380989104382',
'+380989199554',
'+380989212327',
'+380989298877',
'+380989426993',
'+380989459167',
'+380989519208',
'+380989541070',
'+380989560470',
'+380989593842',
'+380989595946',
'+380989710532',
'+380989729660',
'+380989730233',
'+380990158536',
'+380990184958',
'+380990303608',
'+380990384541',
'+380990441560',
'+380990474275',
'+380990727906',
'+380990757006',
'+380991225596',
'+380991319999',
'+380991370027',
'+380991640460',
'+380991735683',
'+380991914949',
'+380991981063',
'+380992075752',
'+380992356554',
'+380992361949',
'+380992447497',
'+380992497810',
'+380992523644',
'+380992526308',
'+380992668612',
'+380992726319',
'+380992773138',
'+380992893541',
'+380992941415',
'+380992950599',
'+380993041224',
'+380993108259',
'+380993154037',
'+380993363402',
'+380993376116',
'+380993402715',
'+380993555489',
'+380993584430',
'+380994152267',
'+380994299050',
'+380994411873',
'+380994441090',
'+380994573900',
'+380994595426',
'+380994616964',
'+380994795966',
'+380994844465',
'+380994846915',
'+380994853853',
'+380994894179',
'+380995055333',
'+380995167087',
'+380995276688',
'+380995326578',
'+380995343555',
'+380995411169',
'+380995439531',
'+380995569499',
'+380995577019',
'+380995600733',
'+380996086969',
'+380996144126',
'+380996243642',
'+380996280033',
'+380996469124',
'+380996680582',
'+380996690389',
'+380997309919',
'+380997362604',
'+380997391783',
'+380997569423',
'+380997675619',
'+380997696299',
'+380997739411',
'+380997793326',
'+380997809026',
'+380999268600',
'+380999309435',
'+380999341069',
'+380999348064',
'+380999363558',
'+380999376735',
'+380999465003',
'+380999591615',
'+380999597820',
'+380999646814',
'+380999683923',
'+380999705715',
'+380999728338',
'+380999766495',
'+380999785178',
'+380999816697'

      );
		$audience = new CustomAudience(null, $actAccount);
		$audience->setData(array(
			CustomAudienceFields::NAME => $name,
			CustomAudienceFields::SUBTYPE => CustomAudienceSubtypes::CUSTOM,
			CustomAudienceFields::DESCRIPTION => $description,
		));
		$audience->create();
		if (!empty($phonesOrEmailsNew)){
//			$audience->addUsers($phonesOrEmails, ($communicationType == 'email' ? CustomAudienceTypes::EMAIL : CustomAudienceTypes::PHONE));
			$audience->addUsers($phonesOrEmailsNew, CustomAudienceTypes::PHONE);
		}

    return $audience->getData()['id'];
	}

  /**
   * @param $audiences
   * @param $phonesOrEmails
   * @param $phonesOrEmailsToRemove
   * @param null $entityName
   * @param null $entityDescription
   * @param $communicationTypeFromData | тип данных (email или телефон) из предыдущей сохраненной аудитории
   * @param $communicationType | тип данных (email или телефон) из новых сохранненых фильтров для обновления аудитории.
   */
	public function updateAudiences($audiences, $phonesOrEmails, $phonesOrEmailsToRemove, $entityName = null, $entityDescription = null, $communicationTypeFromData, $communicationType) {
    $audience = array();
    if (!empty($audiences)) {
      foreach ($audiences as $item) {
        $audience = new CustomAudience($item['external_id']);
        if ($item['can_deleted'] == 0){
          $audience->removeUsers($phonesOrEmailsToRemove, ($communicationTypeFromData == 'email' ? CustomAudienceTypes::EMAIL : CustomAudienceTypes::PHONE));
          $audience->update();
        }
      }
      if (isset($entityName)) {
        $audience->setData(array(CustomAudienceFields::NAME => $entityName));
        $audience->update();
      }
      if (isset($entityDescription)) {
        $audience->setData(array(CustomAudienceFields::DESCRIPTION => $entityDescription));
        $audience->update();
      }
      // Waiting for add new user emails after deleted
      sleep(2);
    }
    trace($phonesOrEmails);
    traced($communicationType);
    if (!empty($phonesOrEmails)) {
      $audience->addUsers($phonesOrEmails, ($communicationType == 'email' ? CustomAudienceTypes::EMAIL : CustomAudienceTypes::PHONE));
    }
	}

  /**
   * @param $actAccount
   * @param $audienceId
   */
	public function deleteAudiences($actAccount, $audienceId){
		$audiences = $this->getAllCustomAudiences($actAccount);
		if (!empty($audiences) && is_array($audiences)){
			foreach ($audiences as $name => $id){
				if ($audienceId == $id){
					$audience = new CustomAudience($audienceId);
					$audience->deleteSelf();
				}
			}
		}
	}

	/**
	 * Get lead data on leedgenID
	 * @param string $leedgenId
	 * @return array
	 */
	public function getLeadData($leedgenId) {
		try {
			// Get the \Facebook\GraphNodes\GraphUser object for the current user.
			// If you provided a 'default_access_token', the '{access-token}' is optional.
			$response = $this->fbGraph->get($leedgenId, 'EAACWNjZCgMwsBAEVZAKmqNCeHSkBKzxnabA5pJ3RRu5FUEpRLe76xLiDC9IbkQgslXVWMD2v507rZC3Q4XfegHQk4AM7fepUAOBMIfVPz9xPnO8FknptjHYEgzOogpHeV6nqZAnCHMYZBRzhLPHd0TUkwWcqIsO4ZD');
		} catch (\Facebook\Exceptions\FacebookResponseException $e) {
			// When Graph returns an error
			log_message('error', 'Graph returned an error: ' . $e->getMessage());
			return null;
		} catch (\Facebook\Exceptions\FacebookSDKException $e) {
			// When validation fails or other local issues
			log_message('error', 'Facebook SDK returned an error: ' . $e->getMessage());
			return null;
		}
		return $response->getDecodedBody();
	}


	/**
	 * Get all leads
	 * @return array
	 * @param string $form_id
	 */
	public function getForms($form_id){
		// Send the request to Graph
		try {
			$response = $this->fbGraph->get('/' .$form_id. '?fields=leads{id,ad_name,is_organic,campaign_name,field_data}', 'EAACWNjZCgMwsBAEVZAKmqNCeHSkBKzxnabA5pJ3RRu5FUEpRLe76xLiDC9IbkQgslXVWMD2v507rZC3Q4XfegHQk4AM7fepUAOBMIfVPz9xPnO8FknptjHYEgzOogpHeV6nqZAnCHMYZBRzhLPHd0TUkwWcqIsO4ZD');
		} catch(Facebook\Exceptions\FacebookResponseException $e) {
			// When Graph returns an error
			echo 'Graph returned an error: ' . $e->getMessage();
			exit;
		} catch(Facebook\Exceptions\FacebookSDKException $e) {
			// When validation fails or other local issues
			echo 'Facebook SDK returned an error: ' . $e->getMessage();
			exit;
		}
		return $response->getDecodedBody();
	}

	/**
	 * initGraphSDK
	 */
	private function initGraphSDK() {
		$this->fbGraph = new \Facebook\Facebook(['app_id' => $this->app_id, 'app_secret' => $this->app_secret, 'default_graph_version' => 'v2.10']);
	}

	/**
	 * initAdsSDK
	 */
  private function initAdsSDK() {
	  // Initialize a new Session and instanciate an Api object
	  Api::init($this->app_id, $this->app_secret, $this->page_token);
	  // The Api object is now available trough singleton
	  $this->fbAds = Api::instance();
  }

}
?>