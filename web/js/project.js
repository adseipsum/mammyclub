function getClassThatStartsWith(c,a){classNames="";if(typeof c.className!=="undefined"){classNames=c.className.split(/\s+/)}else{classNames=c.attr("class").split(/\s+/)}for(var b=0;b<classNames.length;++b){if(classNames[b].indexOf(a)==0){return classNames[b]}}return""}function processProductParamEvents(){if($(".js-product-view").length>0){var a=$(".js-slider");$(".js-select-param1, .js-select-param2").change(function(){if($(this).find("option[value='']").length>0){$(this).find("option[value='']").remove()}if($(".js-param-box").find(".error").length>0){$(".js-param-box").find(".error").each(function(){$(this).removeClass("error");$(this).closest(".row").find(".attention").hide()})}var d=$(".js-select-param1:visible").find("option:selected").val();if($(this).hasClass("js-select-param1")&&$(".js-select-param2:visible").length>0){var b=paramGroupData[d]["values_out"].split(",");$(".js-select-param2:visible option").each(function(){$(this).removeAttr("style");var f=$(this).text().replace(" (под заказ)","");$(this).text(f)})}$(".js-price").text(paramGroupData[d]["price"]);if($(".js-old-price").length>0){$(".js-old-price").text(paramGroupData[d]["old_price"])}$(".js-product-view").data("price",parseInt(paramGroupData[d]["price"]));$(".js-stock-wrap").children(".js-stock-status").css("display","none");if(paramGroupData[d]["in_stock_status"]=="in_stock"){$(".js-stock-wrap").children(".js-in-stock").css("display","inline-block")}else{if(paramGroupData[d]["in_stock_status"]=="in_other_stock"){$(".js-stock-wrap").children(".js-in-other-stock").css("display","inline-block")}else{$(".js-stock-wrap").children(".js-in-stock-default").css("display","inline-block")}}var e=$("a[param-img='"+d+"']");if($(window).width()<660){var c=$(".js-mobile-param-img");if(e.length>0){c.attr("src",e.find("img").attr("src"));c.show();$(".js-mobile-main-img").hide();goToObject(c)}else{if(c.is(":visible")){c.hide();$(".js-mobile-main-img").show()}}}else{if(e.length>0){a.find("li:first").click();var c=$(".js-param-img-container");c.attr("href",e.attr("href"));c.find("img").attr("src",e.find("img").attr("src"));c.show();a.find(".current").removeClass("current");a.find('li[param-li="'+d+'"]').addClass("current")}}});if($(window).width()>660){a.find("img").click(function(){$(".js-param-img-container").hide();if($(".js-select-param1").find("option:selected").val()!=""){$(".js-select-param1").prepend('<option selected="selected" value="">- Выберите -</option>')}if($(".js-select-param2").find("option:selected").val()!=""){$(".js-select-param2").prepend('<option selected="selected" value="">- Выберите -</option>')}});a.find("li").click(function(){a.find(".current").removeClass("current");$(this).addClass("current")})}$(".js-add-to-cart").click(function(){if($(".js-select-param1:visible").length>0){var f=$(".js-select-param1:visible");var e=$(".js-select-param2:visible");if(typeof f!=="undefined"){if(f.find("option:selected").val()==""){f.closest(".row").find(".attention").show();f.addClass("error");if(typeof e!=="undefined"){if(e.find("option:selected").val()==""){e.closest(".row").find(".attention").show();e.addClass("error")}}return false}}var d=f.find("option:selected");var c=e.find("option:selected");var b=$(this).attr("href");if(d.length>0&&d.val()!=""){b+="?param1="+d.val()}if(c.length>0&&c.val()!=""){b+="&param2="+c.val()}$(this).attr("href",b)}var g=$(this).attr("href");if(typeof preAddToCartEvent==="function"){preAddToCartEvent($(".js-product-view").data())}$.ajaxp2OpenPopup(g);return false})}}$(document).ready(function(){$("input.js-date").each(function(){$(this).datepicker({dateFormat:"yy-mm-dd",changeMonth:true,changeYear:true,yearRange:"-80:+10"}).attr("readonly","readonly")});if(document.body.clientWidth<=640){var b=$(".html-content img");b.wrap('<div style="text-align: center; width: 100%;"></div>');b.css("float","");b.css("width","auto")}$(".js-fancybox-image").fancybox();$(".cont-small-box .close").live("click",function(){$(this).toggleClass("open");$(this).text(" (скрыть)");if($(this).hasClass("open")){$(this).text(" (открыть)")}$(".cont-small-box .js-contents").fadeToggle()});$(".js-close-adm-msg").click(function(){$(".flash").fadeToggle()});$(".js-not-implemented").click(function(){alert("В разработке");return false});$(".js-go-to-top").click(function(){$("html, body").animate({scrollTop:0},900,"swing")});if($(".js-broadcast-block").length>0){sidebarBlockScrolling($(".js-broadcast-block"))}if($(".js-view-item .print").length>0){$(".js-view-item .print").print()}$("#order_form").append('<input type="hidden" name="not_bot" value="1" />');$(".js-nb").append('<input type="hidden" name="nb" value="1" />');var a=["js-filters"];for(i=0;i<a.length;++i){$(".filter-box ."+a[i]).click(function(){if($(this).parents("li").hasClass("disabled")){return false}var e=getClassThatStartsWith(this,"js-filtervalue-idtype-").replace("js-filtervalue-idtype-","");var h=e.split("_");var g=h[0];var d=h[1];if(h.length==3){d+="["+h[2]+"]"}var f=$.query.GET(d);if(typeof f!=="undefined"&&f.length>0){var c=f.indexOf(g);if(c!=-1){delete f[c]}else{f[f.length]=g}$.query.SET(d,f)}else{$.query.SET(d,[g])}window.location.search=$.query.toString();return false})}});function sidebarBlockScrolling(d){var b=Math.round($(d).position().top);var a=Math.round($(".js-footer").position().top)-$(d).height()-150;$(window).scroll(function(f){c()});c();function c(){if($(window).scrollTop()>b){if($(window).scrollTop()<a){var e=Math.round($(window).scrollTop()-b);$(d).css("marginTop",e+40)}}else{$(d).css("marginTop",0)}}}function removeTiny(a){tinymce.remove(a)}function initTiny(a){tinymce.init({height:"320px",selector:a,language:"ru",toolbar:"undo redo | bold italic | bullist numlist outdent indent blockquote | link jbimages | emoticons",menubar:false,statusbar:false,plugins:"emoticons, link, jbimages, paste",paste_auto_cleanup_on_paste:true,paste_retain_style_properties:"all",paste_webkit_styles:"all",paste_retain_style_properties:"color font-size",image_upload_action:base_url+"загрузить-изображение",content_css:tiny_mce_css,relative_urls:false,remove_script_host:false})}function pregnancyWeekCommentsAction(b){if(isLoggedIn===1){initTiny("#myText");$(".js-review-form").fadeIn();$(b).parent().hide();var a=$(".js-distribution-box");if(a.length>0){sidebarBlockScrolling($(".js-distribution-box"))}}else{lastClickedElemet=$(b);$(".js-register").click()}}function commentsAction(a){if(isLoggedIn===1){$(".comment-box .js-answer").show();removeTiny("#myText");$('.js-comment-form-stub input[name="parent_id"]').val("");$(".js-comment-form").append($(".js-comment-form-stub"));$(".js-comment-form-stub").show();initTiny("#myText");$(".js-comment-form").fadeIn();a.parent().hide()}else{lastClickedElemet=$(a);$(".js-register").click()}}function answerToComment(a){if(isLoggedIn===1){$(".comment-box .js-answer").show();a.hide();$(".js-show-comment").hide();removeTiny("#myText");$(".js-show-comment").parent().show();$(".js-comment-form").hide();$('.js-comment-form-stub input[name="parent_id"]').val(a.parents("li:first").attr("id").replace("commentid_",""));a.parents("li:first").after($(".js-comment-form-stub"));$(".js-comment-form-stub").show();initTiny("#myText")}else{lastClickedElemet=$(a);$(".js-register").click()}}function gotoId(a){$("html, body").animate({scrollTop:$(a).offset().top},300,"swing")}function goToObject(a){$("html, body").animate({scrollTop:a.offset().top},300,"swing")}function commentCancel(){removeTiny("#myText");$(".js-comment-form").hide();$(".js-comment-form-stub").hide();$(".comment-box .js-answer").show();$(".js-show-comment").parent().show();$(".js-show-comment").show()}(function(a){a.fn.outside=function(c,b){return this.each(function(){var f=a(this),d=this;a(document).bind(c,function e(g){if(g.target!==d&&!a.contains(d,g.target)){b.apply(d,[g]);if(!d.parentNode){a(document.body).unbind(c,e)}}})})}}(jQuery));