var auth=new function(){this.facebook_login=function(i){window.open(js_auth_config.initiator_url+"/facebook/"+i,"Facebook authentication","width=600, height=400");return false};this.gmail_login=function(i){window.open(js_auth_config.initiator_url+"/gmail/"+i,"Gmail authentication","width=600, height=400");return false};var c=Object({session:null,profile:null,redirectURL:null});this.vkontakte_login=function(i){c.redirectURL=js_auth_config.auth_url+"/vkontakte/"+i;VK.Auth.login(e);return false};function e(i){if(i.session){vk_session=VK.Auth.getSession();c.session=vk_session;VK.Api.call("getProfiles",{uids:vk_session.mid,fields:"first_name,last_name,nickname,sex,photo_big,contacts,bdate,city"},h)}}function h(i){c.profile=i.response[0];if(c.profile.city&&c.profile.city!="0"){VK.Api.call("places.getCityById",{cids:c.profile.city},f)}else{b()}}function f(i){c.profile.city_title=i.response[0].name;b()}function b(){$.PopupAjaxManager.redirect(c.redirectURL,{session:$.toJSON(c.session),profile:$.toJSON(c.profile)})}var a=Object({redirectURL:null});this.mailru_login=function(i){a.redirectURL=js_auth_config.auth_url+"/mailru/"+i;mailru.connect.getLoginStatus(function(j){if(j.is_app_user!=1){mailru.connect.login()}else{g(j)}});return false};function d(j,i){$.PopupAjaxManager.redirect(a.redirectURL,{session:$.toJSON(j),profile:$.toJSON(i)})}function g(i){mailru.common.users.getInfo(function(j){d(i,j[0],i.vid)})}if(js_auth_config.load_api){$.getScript("http://cdn.connect.mail.ru/js/loader.js",function(){if(typeof mailru=="object"){mailru.loader.require("api",function(){mailru.connect.init(js_auth_config.mailru_app_id,js_auth_config.mailru_app_key);mailru.events.listen(mailru.connect.events.login,g)})}});window.vkAsyncInit=function(){VK.init({apiId:js_auth_config.vkontakte_app_id,nameTransportPath:"/web/js/common/xd_receiver.html"})}}};