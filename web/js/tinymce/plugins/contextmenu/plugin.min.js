tinymce.PluginManager.add("contextmenu",function(b){var a,c=b.settings.contextmenu_never_use_native;b.on("contextmenu",function(h){var f,j=b.getDoc();if(!h.ctrlKey||c){if(h.preventDefault(),tinymce.Env.mac&&tinymce.Env.webkit&&2==h.button&&j.caretRangeFromPoint&&b.selection.setRng(j.caretRangeFromPoint(h.x,h.y)),f=b.settings.contextmenu||"link image inserttable | cell row column deletetable",a){a.show()}else{var e=[];tinymce.each(f.split(/[ ,]/),function(i){var k=b.menuItems[i];"|"==i&&(k={text:i}),k&&(k.shortcut="",e.push(k))});for(var g=0;g<e.length;g++){"|"==e[g].text&&(0===g||g==e.length-1)&&e.splice(g,1)}a=new tinymce.ui.Menu({items:e,context:"contextmenu"}).addClass("contextmenu").renderTo(),b.on("remove",function(){a.remove(),a=null})}var d={x:h.pageX,y:h.pageY};b.inline||(d=tinymce.DOM.getPos(b.getContentAreaContainer()),d.x+=h.clientX,d.y+=h.clientY),a.moveTo(d.x,d.y)}})});