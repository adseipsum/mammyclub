tinymce.PluginManager.add("preview",function(c){var b=c.settings,a=!tinymce.Env.ie;c.addCommand("mcePreview",function(){c.windowManager.open({title:"Preview",width:parseInt(c.getParam("plugin_preview_width","650"),10),height:parseInt(c.getParam("plugin_preview_height","500"),10),html:'<iframe src="javascript:\'\'" frameborder="0"'+(a?' sandbox="allow-scripts"':"")+"></iframe>",buttons:{text:"Close",onclick:function(){this.parent().parent().close()}},onPostRender:function(){var j,e="";e+='<base href="'+c.documentBaseURI.getURI()+'">',tinymce.each(c.contentCSS,function(d){e+='<link type="text/css" rel="stylesheet" href="'+c.documentBaseURI.toAbsolute(d)+'">'});var g=b.body_id||"tinymce";-1!=g.indexOf("=")&&(g=c.getParam("body_id","","hash"),g=g[c.id]||g);var i=b.body_class||"";-1!=i.indexOf("=")&&(i=c.getParam("body_class","","hash"),i=i[c.id]||"");var h=c.settings.directionality?' dir="'+c.settings.directionality+'"':"";if(j="<!DOCTYPE html><html><head>"+e+'</head><body id="'+g+'" class="mce-content-body '+i+'"'+h+">"+c.getContent()+"</body></html>",a){this.getEl("body").firstChild.src="data:text/html;charset=utf-8,"+encodeURIComponent(j)}else{var f=this.getEl("body").firstChild.contentWindow.document;f.open(),f.write(j),f.close()}}})}),c.addButton("preview",{title:"Preview",cmd:"mcePreview"}),c.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})});