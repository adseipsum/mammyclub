$.fn.switchselect=function(b){var c=$('<img class="cp" src="'+base_url+'/web/images/input_typing_icon.png"/>');var d=$('<div class="switch-select-box"></div>');var e=25;var a=0;return this.filter("select").each(function(){var j=$(this),m,n,h,l,s,g=false,r;if(!a){a=j.width()}h=c.clone();l=d.clone();l.css("width",a);j.wrap(l);l=j.parent();j.after(h);j.width(a-e);function o(u,w){var v,t;jQuery(function(){var x=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g");v={fnFormatResult:function(B,A,y){var z="("+y.replace(x,"\\$1")+")";return B.replace(new RegExp(z,"gi"),'<span class="orange-color">$1</span>')},onSelect:function(y){q(y)},lookup:w,width:j.width(),extraClass:"switch-select-autocomplete"};t=u.ajaxautocomplete(v)});return t}function i(){r=[];j.children().each(function(){if($(this).val()&&$(this).val()!=0){r.push($(this).text())}});k();s=o(m,r);n=$('<img class="cp" src="'+base_url+'/web/images/select_icon.png"/>');m.after(n);n.click(q);return false}function k(){m=$('<input class="input-text" type="text" placeholder="" />');l.append(m);l.append('<div class="clear"></div>');var u=m.outerWidth()-m.width();var t=j.outerWidth()-u;m.width(t);m.keypress(function(w){var v=w.keyCode||w.which;if(v==27){q()}});return false}function f(){j.hide();h.hide();if(!g){i();g=true}m.val();m.show();n.show();m.focus();return false}function q(t){var u=t?t:m.val();p(u);j.show();h.show();m.hide();n.hide();setTimeout(function(){j.focus()},10);return false}function p(v){var t=$.inArray(v,r);if(j.children('option[value=""],option[value="0"]').length>0){t++}if(t!=-1){var u=j.children(":eq("+t+")");u.attr("selected","selected")}else{j.val("")}return false}h.click(f);j.keypress(function(v){var t=v.keyCode||v.which;var u=String.fromCharCode(t);if(u.match(/[A-Za-zа-яА-Я0-9]/)){f();m.val(u);s.ignoreValueChange=false;s.onValueChange()}});return this})};