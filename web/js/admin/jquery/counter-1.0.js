(function(a){a.fn.extend({counter:function(c){var d={type:"char",count:"down",goal:140};var c=a.extend({},d,c);var b=false;return this.each(function(){var g;var h=a(this);function e(i){if(typeof c.type!=="string"){}else{switch(c.type){case"char":if(c.count==="down"){g=" character(s) left";return(c.goal-i)}else{if(c.count==="up"){if(c.goal){g=" characters ("+c.goal+" max)"}else{g=" characters"}return i}}break;case"word":if(c.count==="down"){g=" word(s) left";return(c.goal-i)}else{if(c.count==="up"){g=" words ("+c.goal+" max)";return i}}break;default:}}}var f;if(h.next().find(".counter").length>0){f=h.next().find(".counter").attr("id",this.id+"_counter");f.html(e(a(h).val().length))}else{a('<div id="'+this.id+'_counter" class="counter description"><span>'+e(a(h).val().length)+"</span>"+g+"</div>").insertAfter(h);f=a("#"+this.id+"_counter span")}h.bind("keyup click blur focus change paste",function(i){switch(c.type){case"char":i=a(h).val().length;break;case"word":if(h.val()===""){i=0}else{i=a.trim(h.val()).replace(/\s+/g," ").split(" ").length}break;default:}if(c.goal){switch(c.count){case"up":if(e(i)>=c.goal&&c.type==="char"){a(this).val(a(this).val().substring(0,c.goal));b=true;break}if(e(i)===c.goal&&c.type==="word"){b=true;break}else{if(e(i)>c.goal&&c.type==="word"){a(this).val("");f.text("0");b=true;break}}break;case"down":if(e(i)<=0&&c.type==="char"){a(this).val(a(this).val().substring(0,c.goal));b=true;break}if(e(i)===0&&c.type==="word"){b=true}else{if(e(i)<0&&c.type==="word"){a(this).val("");b=true;break}}break;default:}}h.keydown(function(j){if(b){this.focus();if((j.keyCode!==46&&j.keyCode!==8)){if(c.goal&&a(this).val().length>c.goal&&c.type==="char"){a(this).val(a(this).val().substring(0,c.goal));return false}else{if(j.keyCode!==32&&j.keyCode!==8&&c.type==="word"){return true}else{return false}}}else{b=false;return true}}});f.text(e(i))})})}})})(jQuery);